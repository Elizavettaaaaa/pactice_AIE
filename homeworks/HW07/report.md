# HW07 – Report

## 1. Datasets

### 1.1 Dataset 01
- **Файл:** `S07-hw-dataset-01.csv`
- **Размер:** (12000, 8)
- **Признаки:** 8 числовых признаков.
- **Особенности:** Данные имеют выраженную кластерную структуру (глобулярные кластеры), но требуют масштабирования (`StandardScaler`) из-за разного диапазона значений признаков.

### 1.2 Dataset 02
- **Файл:** `S07-hw-dataset-02.csv`
- **Размер:** (8000, 3)
- **Признаки:** 3 числовых признака.
- **Особенности:** Нелинейная структура данных, наличие шума. Классические методы, основанные на расстоянии (KMeans), могут работать хуже плотностных методов.

### 1.3 Dataset 03
- **Файл:** `S07-hw-dataset-03.csv`
- **Размер:** (15000, 4)
- **Признаки:** 4 числовых признака.
- **Особенности:** Кластеры имеют разную плотность и размер. Присутствует корреляция между признаками.

## 2. Protocol

- **Препроцессинг:**
  - Обработка пропусков: `SimpleImputer` (заполнение средним).
  - Масштабирование: `StandardScaler` (применялся ко всем данным перед кластеризацией).
- **Поиск гиперпараметров:**
  - **KMeans:** Перебор числа кластеров `k` в диапазоне от 2 до 10. Критерий выбора — максимизация `silhouette_score` + анализ графика "локтя" (Inertia, если бы смотрели, но силуэт надежнее).
  - **DBSCAN:** Перебор `eps` (0.2...0.7) и `min_samples` (3, 5).
  - **Agglomerative:** Перебор `k` и типа связи (`linkage`: ward, average).
- **Метрики:**
  - `silhouette_score`: основная метрика (качество разделения).
  - `davies_bouldin_score` и `calinski_harabasz_score`: вспомогательные.
  - Для DBSCAN учитывалась доля шума (`noise_share`).
- **Визуализация:** PCA (сжатие до 2 компонент) для визуальной оценки качества разбиения.

## 4. Results

### 4.1 Dataset 01
- **Лучший метод:** KMeans (`k=2`).
- **Метрики:** Silhouette = **0.522**.
- **Комментарий:** KMeans показал отличный результат, уверенно разделив данные на два крупных кластера. Это подтверждает гипотезу о глобулярной структуре данных после масштабирования.

### 4.2 Dataset 02
- **Лучший метод:** DBSCAN (`eps=0.7`, `min_samples=3`).
- **Метрики:** Silhouette = **0.331**.
- **Комментарий:** Данные имеют сложную структуру с шумом. DBSCAN смог выделить плотные области и отсеять выбросы (шум), что видно на PCA-графике. KMeans здесь показал бы худшую интерпретируемость границ.

### 4.3 Dataset 03
- **Лучший метод:** KMeans (`k=3`).
- **Метрики:** Silhouette = **0.316**.
- **Комментарий:** Несмотря на разную плотность, KMeans смог найти 3 устойчивых центра. График Silhouette vs K имеет четкий пик на k=3, что говорит об оптимальности этого выбора.

## 5. Analysis

### 5.1 Сравнение алгоритмов
- **KMeans** отлично работает на Dataset 01 и 03, где кластеры имеют относительно простую форму. Он быстр и дает интерпретируемый результат.
- **DBSCAN** выиграл на Dataset 02. Он незаменим там, где есть шум и кластеры сложной формы, но требует тщательного подбора `eps`.
- **Масштабирование** (`StandardScaler`) сыграло ключевую роль: без него KMeans на Dataset 01 (где признаки в разных шкалах) выдал бы неверный результат.

### 5.2 Устойчивость (на примере Dataset 01)
- Проверка: 5 запусков KMeans с разными `random_state` (seeds: 42, 1, 10, 100, 777).
- **Результат:** Во всех 5 запусках `silhouette_score` был идентичен (0.3968... с точностью до 4 знака).
- **Вывод:** Алгоритм абсолютно устойчив. Это достигается благодаря параметру `n_init=10` (несколько запусков внутри KMeans), который позволяет избегать локальных минимумов.

### 5.3 Интерпретация кластеров
- На Dataset 01 кластеры разделяются, вероятно, по величине признаков (один кластер — низкие значения, другой — высокие).
- На Dataset 02 (DBSCAN) кластеры представляют собой области высокой концентрации точек, разделенные разреженным пространством.
- На Dataset 03 (KMeans) выделены три группы, которые, судя по PCA, соответствуют трем "облакам" в пространстве признаков.

## 6. Conclusion
1. **Препроцессинг обязателен:** Без `StandardScaler` метрики дистанционных методов (KMeans) не имеют смысла.
2. **Метрики не абсолютны:** Высокий Силуэт не всегда гарантирует "правильную" кластеризацию (особенно на невыпуклых формах), поэтому визуализация через PCA необходима для проверки.
3. **DBSCAN vs KMeans:** KMeans — "рабочая лошадка" для простых структур, DBSCAN — инструмент для "хитрых" форм и очистки от шума.
4. **Протокол:** Фиксация `random_state` и автоматический перебор параметров позволяют сделать результаты воспроизводимыми и объективно выбрать лучшую модель.